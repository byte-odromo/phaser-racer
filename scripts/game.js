!function t(e,r,i){function o(a,s){if(!r[a]){if(!e[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(n)return n(a,!0);var h=new Error("Cannot find module '"+a+"'");throw h.code="MODULE_NOT_FOUND",h}var u=r[a]={exports:{}};e[a][0].call(u.exports,function(t){var r=e[a][1][t];return o(r?r:t)},u,u.exports,t,e,r,i)}return r[a].exports}for(var n="function"==typeof require&&require,a=0;a<i.length;a++)o(i[a]);return o}({1:[function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a,s,c=function(t,e,r){for(var i=!0;i;){var o=t,n=e,a=r;i=!1,null===o&&(o=Function.prototype);var s=Object.getOwnPropertyDescriptor(o,n);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(a)}var h=Object.getPrototypeOf(o);if(null===h)return;t=h,e=n,r=a,i=!0,s=h=void 0}},h=t("./states/RaceGameState"),u=i(h),l=800,f=600,d=window.innerWidth,p=window.innerHeight;p>d?(a=p,s=d):(a=d,s=p);var g=a/s,y=l/f,v=0,b=0;g>y?v=g*f-l:b=l/g-f;var w=function(t){function e(){o(this,e),c(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,"100%","100%",Phaser.AUTO,"phaser-racer",null),this.state.add("phaser-racer",u["default"],!1),this.state.start("phaser-racer")}return n(e,t),e}(Phaser.Game);new w},{"./states/RaceGameState":7}],2:[function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),s=function(t,e,r){for(var i=!0;i;){var o=t,n=e,a=r;i=!1,null===o&&(o=Function.prototype);var s=Object.getOwnPropertyDescriptor(o,n);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(a)}var h=Object.getPrototypeOf(o);if(null===h)return;t=h,e=n,r=a,i=!0,s=h=void 0}},c=t("./FXs"),h=i(c),u=2.5,l=function(t){function e(t,r,i,n){o(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t,t.world.centerX,t.world.centerY,r),this.frontAnchor=n,this.texture.baseTexture.scaleMode=PIXI.scaleModes.LINEAR,this.anchor.set(.5),this.scale=new Phaser.Point(.15*u,.15*u),this.debugInfo=new Map;var a=this.game.state.getCurrentState();this.game=t,this.key=r,this.gridPosition=i,this.track=a.track,this.startAt=i.position,this.accelerate=!1,this.tween=null,this.accelerationRate=.005,this.maxSpeed=1,this.slowDownRate=.01,this.userInteractionAllowed=!1,this.crushed=!1,this.rotation2Restore,this.crushFactor,this.FXs=new h["default"]}return n(e,t),a(e,[{key:"init",value:function(){var t=this;this.game.physics.box2d.enable(this,!0);var e=(this.track.path.getTotalLength(),this.startAt),r=this.track.path.getPointAtLength(e);this.body.x=r.x*u+30,this.body.y=r.y*u,this.body.angle=-90,this.body.gravityScale=0,this.body.friction=9,this.body.restitution=-10,this["static"]=!1,this.body.linearDamping=10,window.car=this,setTimeout(function(){var e=t.game.physics.box2d.distanceJoint(t.frontAnchor,t,10,0,0,0,-10*u,300,80);e.collideConnected=!1},100),this.userInteractionAllowed=!0;var i={progress:0};this.rotation,this.rotation;i.onUpdate=function(t,e){var r=this.track.path.getTotalLength(),i=this.startAt+r*e;i>=r&&(i-=r);var o=this.track.path.getPointAtLength(i);this.frontAnchor.x=o.x*u,this.frontAnchor.y=o.y*u,this.detectCrush(),this.debugInfo.set("dsit",Phaser.Math.distance(this.position.x,this.position.y,this.frontAnchor.x,this.frontAnchor.y))};var o=5e3;this.tween=this.game.add.tween(i).to({progress:1},o),this.tween.timeScale=0,this.tween.onUpdateCallback(i.onUpdate.bind(this)),this.tween.repeat(this.game.state.getCurrentState().raceLaps-1),this.tween.start()}},{key:"detectCrush",value:function(){var t=Phaser.Math.distance(this.position.x,this.position.y,this.frontAnchor.x,this.frontAnchor.y);t>125&&this.crush()}},{key:"throttleOn",value:function(){this.accelerate=!0}},{key:"throttleOff",value:function(){this.accelerate=!1}},{key:"crush",value:function(){this.userInteractionAllowed=!1,this.crushed=!0,setTimeout(function(){this.userInteractionAllowed=!0,this.crushed=!1}.bind(this),2e3)}},{key:"update",value:function(){this.accelerate&&this.userInteractionAllowed?(this.body.applyForce(.1,.1),this.tween.timeScale+=this.accelerationRate,this.tween.timeScale>this.maxSpeed&&(this.tween.timeScale=this.maxSpeed),this.tween.timeScale<this.maxSpeed/2?this.FXs.startTireMarks(this):this.FXs.isMarkingTires&&this.FXs.stopTireMarks(this)):(this.tween.timeScale-=this.slowDownRate*(this.crush?2:1),this.tween.timeScale<0&&(this.tween.timeScale=0),this.FXs.isMarkingTires&&this.FXs.stopTireMarks(this))}}]),e}(Phaser.Sprite);r["default"]=l,e.exports=r["default"]},{"./FXs":3}],3:[function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(){function t(){i(this,t),this.car,this.tiresMark,this.isMarkingTires=!1,this.lastPosition}return o(t,[{key:"startTireMarks",value:function(t){this.car=t,this.isMarkingTires=!0;var e=this.car.position,r=this.lastPosition||e,i=this.getRearLeftTirePos(e),o=this.getRearLeftTirePos(r),n=this.getRearRightTirePos(e),a=this.getRearRightTirePos(r);this.tiresMark||(this.tiresMark=this.car.game.add.graphics(0,0),this.car.game.world.swapChildren(this.tiresMark,this.car),this.tiresMark.lineStyle(4,3355443,.5),this.tiresMark.moveTo(o.x,o.y)),this.tiresMark.moveTo(o.x,o.y),this.tiresMark.lineTo(i.x,i.y),this.tiresMark.moveTo(a.x,a.y),this.tiresMark.lineTo(n.x,n.y),this.lastPosition={x:this.car.position.x,y:this.car.position.y}}},{key:"getRearLeftTirePos",value:function(t){return{x:t.x+Math.cos(this.car.rotation+Phaser.Math.degToRad(60))*(this.car.width/1.5),y:t.y+Math.sin(this.car.rotation+Phaser.Math.degToRad(60))*(this.car.width/1.5)}}},{key:"getRearRightTirePos",value:function(t){return{x:t.x+Math.cos(this.car.rotation+Phaser.Math.degToRad(120))*(this.car.width/1.5),y:t.y+Math.sin(this.car.rotation+Phaser.Math.degToRad(120))*(this.car.width/1.5)}}},{key:"stopTireMarks",value:function(t){this.isMarkingTires=!1,this.tiresMark=void 0,this.lastPosition=void 0}},{key:"carSmoke",value:function(t){}}]),t}();r["default"]=n,e.exports=r["default"]},{}],4:[function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(){function t(e){i(this,t),this._game=e,this._goPhrase="GO!",this._}return o(t,[{key:"start",value:function(t){var e=this;return new Promise(function(r,i){for(var o=t;o>0;o--)e.setTimeCountUI(o-1,e.getAsset(t-o+1));e.setTimeCountUI(t,e.getAsset(e._goPhrase)),setTimeout(function(){r()},1e3*t)})}},{key:"getAsset",value:function(t){var e={font:"128px Arial",fontWeight:"bold",fill:"#ff0044",align:"center"},r=this._game.add.text(this._game.world.centerX,this._game.world.centerY,t,e);return r.anchor.set(.5),r.alpha=0,r}},{key:"setTimeCountUI",value:function(t,e){setTimeout(this.drawTime.bind(this,e),1e3*t)}},{key:"drawTime",value:function(t){t.alpha=1;var e=this._game.add.tween(t).to({alpha:0}).start();this._game.add.tween(t.scale).to({x:2,y:2}).start(),e.onComplete.add(function(){t.destroy()},this)}}]),t}();r["default"]=n,e.exports=r["default"]},{}],5:[function(t,e,r){"use strict";function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var n=function(t,e,r){for(var i=!0;i;){var o=t,n=e,a=r;i=!1,null===o&&(o=Function.prototype);var s=Object.getOwnPropertyDescriptor(o,n);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(a)}var h=Object.getPrototypeOf(o);if(null===h)return;t=h,e=n,r=a,i=!0,s=h=void 0}},a=function c(){o(this,c),this.path=document.createElementNS("http://www.w3.org/2000/svg","path"),this.path.setAttribute("d","M256.17,206.32h93.47c41.261,0,74.82-33.561,74.82-74.82s-33.56-74.82-74.82-74.82h-216c-41.26,0-74.82,33.56-74.82,74.82s33.56,74.82,74.82,74.82c0,0,61.897,0,82.53,0c18.83,0,20.67,22.68,40,22.68h91.33c53.85,0,97.5-43.65,97.5-97.5c0-53.85-43.65-97.5-97.5-97.5h-216c-26.92,0-51.3,10.91-68.94,28.56C44.91,80.2,34,104.58,34,131.5c0,53.85,43.65,97.5,97.5,97.5c0,0,63.502,0,84.67,0C233,229,236.75,206.32,256.17,206.32z"),this.path.setAttribute("d","m 301.39728,204.32 45.47,0 c 41.261,0 74.82,-35.561 74.82,-76.82 0,-41.259 -33.56,-74.82 -74.82,-74.82 l -216,0 c -41.26,0 -74.820004,33.56 -74.820004,74.82 0,41.26 33.560004,76.82 74.820004,76.82 0,0 41.897,0 62.53,0 47.38283,0 59.36578,22.68 108,22.68 l 43.33,0 c 53.85,0 97.5,-45.65 97.5,-99.5 0,-53.85 -43.65,-97.5 -97.5,-97.5 l -216,0 c -26.92,0 -51.300004,10.91 -68.940004,28.56 -17.65,17.64 -28.56,42.02 -28.56,68.94 0,53.85 43.65,99.5 97.500004,99.5 0,0 43.502,0 64.67,0 46.13422,0 58.52439,-22.68 108,-22.68 z"),this.gridPositions=[{position:this.path.getTotalLength()/1.505,direction:270*Math.PI/180},{position:this.path.getTotalLength()/6,direction:270*Math.PI/180}]},s=function(t){function e(t){o(this,e),n(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t,t.world.centerX,t.world.centerY,"ground"),this.texture.baseTexture.scaleMode=PIXI.scaleModes.LINEAR,this.anchor.set(0),this.scale=new Phaser.Point(.9125,.925),this.position.x=0,this.position.y=0}return i(e,t),e}(Phaser.Sprite);r["default"]={Track_0:a,Track_0_background:s},e.exports=r["default"]},{}],6:[function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var n=function(t,e,r){for(var i=!0;i;){var o=t,n=e,a=r;i=!1,null===o&&(o=Function.prototype);var s=Object.getOwnPropertyDescriptor(o,n);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(a)}var h=Object.getPrototypeOf(o);if(null===h)return;t=h,e=n,r=a,i=!0,s=h=void 0}},a=function(t){function e(t){i(this,e),n(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t,t.world.centerX,t.world.centerY,"tree1"),this.texture.baseTexture.scaleMode=PIXI.scaleModes.LINEAR,this.anchor.set(0),this.position.x=0,this.position.y=0}return o(e,t),e}(Phaser.Sprite);r["default"]=a,e.exports=r["default"]},{}],7:[function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),s=function(t,e,r){for(var i=!0;i;){var o=t,n=e,a=r;i=!1,null===o&&(o=Function.prototype);var s=Object.getOwnPropertyDescriptor(o,n);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(a)}var h=Object.getPrototypeOf(o);if(null===h)return;t=h,e=n,r=a,i=!0,s=h=void 0}},c=t("./../objects/Tracks"),h=t("./../objects/Car"),u=i(h),l=t("./../objects/Tree"),f=i(l),d=t("./../objects/Judge"),p=i(d),g=function(t){function e(){o(this,e);for(var t=arguments.length,r=Array(t),i=0;t>i;i++)r[i]=arguments[i];s(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,r),this.player1={},this.player2={},this.track=null}return n(e,t),a(e,[{key:"preload",value:function(){this.load.crossOrigin="anonymous",this.game.load.image("redCar","./assets/gfx/red_car.png"),this.game.load.image("blueCar","./assets/gfx/blue_car.png"),this.game.load.image("ground","./assets/gfx/track_0_background.png"),this.game.load.image("tree1","./assets/gfx/tree1_tile.png"),this.game.load.image("grass","./assets/gfx/grass_tile.png")}},{key:"create",value:function(){window.gameState=this,this.game.physics.startSystem(Phaser.Physics.BOX2D),this.game.physics.box2d.setBoundsToWorld(),this.game.physics.box2d.restitution=0,this.game.physics.box2d.friction=2,this.game.stage.backgroundColor=284683;var t=(this.game.add.tileSprite(0,0,window.innerWidth,window.innerHeight,"grass"),new f["default"](this.game));this.game.add.existing(t),t.position.x=this.game.world.centerX,t.position.y=this.game.world.centerY/2,this.track=new c.Track_0,this.raceLaps=3,this.game.add.existing(new c.Track_0_background(this.game)),this.player1=this.addCar(1),this.player2=this.addCar(2);var e=new Phaser.Physics.Box2D.Body(this.game,null,this.game.world.centerX,15,1e3);this.game.physics.box2d.enable(e,!0),e.setCircle(5),e["static"]=!0;var r=new p["default"](this.game);r.start(3).then(this.onGo.bind(this)),this.debug=!1}},{key:"addCar",value:function(t){var e=1==t?"redCar":"blueCar",r=1==t?this.track.gridPositions[0]:this.track.gridPositions[1],i=1==t?Phaser.Keyboard.R:Phaser.Keyboard.B,o=new Phaser.Physics.Box2D.Body(this.game,null,this.game.world.centerX,this.game.world.centerY,.5);this.game.physics.box2d.enable(o,!0);var n=this.game.add.existing(new u["default"](this.game,e,r,o));n.init();var a=this.input.keyboard.addKey(i);return a.onDown.add(n.throttleOn.bind(n),this),a.onUp.add(n.throttleOff.bind(n),this),n.userInteractionAllowed=!1,n}},{key:"onGo",value:function(){this.player1.userInteractionAllowed=!0,this.player2.userInteractionAllowed=!0}},{key:"zoomTo",value:function(t){var e=(arguments.length<=1||void 0===arguments[1]?500:arguments[1],this.bounds),r=this.game.camera.bounds;r.x=e.width*(1-t)/2,r.y=e.height*(1-t)/2,r.width=e.width*t,r.height=e.height*t}}]),e}(Phaser.State);r["default"]=g,e.exports=r["default"]},{"./../objects/Car":2,"./../objects/Judge":4,"./../objects/Tracks":5,"./../objects/Tree":6}]},{},[1]);